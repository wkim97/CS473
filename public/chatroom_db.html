<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8" />
	<link rel="stylesheet" type="text/css"
	href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.css">
	<script src="https://code.jquery.com/jquery-3.1.1.min.js"
	integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.js"></script>




</head>


<body>


	<form class="ui form" method="POST">
		<div class="field">
			<label>chat</label>
			<input type="single_chat" name="chat" placeholder="Chat" id="chat">
		</div>
		<input type="button" name="button" value="Send_message"onclick="send_message()">

	</form>

	<!-- The core Firebase JS SDK is always required and must be listed first -->
	<script src="https://www.gstatic.com/firebasejs/7.4.0/firebase-app.js"></script>

	<!-- TODO: Add SDKs for Firebase products that you want to use https://firebase.google.com/docs/web/setup#available-libraries -->
	<script src="https://www.gstatic.com/firebasejs/7.4.0/firebase-auth.js"></script>
	<script src="https://www.gstatic.com/firebasejs/7.4.0/firebase-functions.js"></script>
	<script src="https://www.gstatic.com/firebasejs/7.4.0/firebase-storage.js"></script>
	<script src="https://www.gstatic.com/firebasejs/7.4.0/firebase-database.js"></script>

	<script>
      // Your web app's Firebase configuration
      var firebaseConfig = {
      	apiKey: "AIzaSyAD0Y04NLAtEukphcSJ1s6T8Ffp_AWx-ew",
      	authDomain: "galbi-3ce0c.firebaseapp.com",
      	databaseURL: "https://galbi-3ce0c.firebaseio.com",
      	projectId: "galbi-3ce0c",
      	storageBucket: "galbi-3ce0c.appspot.com",
      	messagingSenderId: "287266351759",
      	appId: "1:287266351759:web:3bdf04f7e5202420549efa"
      };
      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);

      // Get a reference to the database service
      var database = firebase.database();

      var ref_Dummy_Chatroom = database.ref('Chatroom/Dummy_Chatroom');


      function send_message(){

      	var message = document.getElementById("chat").value;
      	var date = new Date();
      	var year = date.getFullYear() + "";
      	var month = (date.getMonth() + 1) + "";
      	month = (month[1] ? month : '0' + month);
      	var day = date.getDate() + "";
      	day = (day[1] ? day : '0' + day);
      	var hour = date.getHours() + "";
      	hour = (hour[1] ? hour : '0' + hour);
      	var minute = date.getMinutes() + "";
      	minute = (minute[1] ? minute : '0' + minute);
      	var second = date.getSeconds() + "";
      	second = (second[1] ? second : '0' + second);
      	var ms = date.getMilliseconds() + "";
      	var thistime = year + month + day + hour + minute + second + ms;
      	ref_Dummy_Chatroom.child('Respond_Chat' + thistime).set({
      		User : "here chatroom db",
      		Content : message
      	});

      }





   //   function display_message(chat_object){

		 // alert("reach here");
   //    	// alert(chat_object);
   //    	// alert(chat_object.val());



   //    	// var textbox = document.createElement("p");
   //    	// document.body.appendChild(textbox);
   //    	//textbox.innerHTML = message;

   //    }


     var chat_data_ref = database.ref('Chatroom/Dummy_Chatroom').on('child_added', function(snapshot){

     	console.log(snapshot.val());
      	var str_snapshot = JSON.stringify(snapshot);


      	var temp = str_snapshot.split(',')
      	var chat = temp[0].split(':')[1].replace(/['"{}]+/g, '');
      	var user = temp[1].split(':')[1].replace(/['"{}]+/g, '');

      	var each_chat= user + ' : ' + chat;



      	var textbox = document.createElement("p");
      	document.body.appendChild(textbox);
      	textbox.innerHTML = each_chat;

      });    

 </script>





</body>

</html>